{% load static %}
<!DOCTYPE html>
<!--
Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
Click nbfs://nbhost/SystemFileSystem/Templates/Other/html.html to edit this template
-->
<html>
    <head>
        <title>Galaxy Retail System</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta charset="UTF-8">
        <meta name="description" content="GALAXY Retail system">
        <meta name="keywords" content="pos,point,sale,inventory,management,best,first,retail,system">
        <meta name="author" content="Raouf Mostafa">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="icon" type="image/x-icon" href="{% static 'images/galaxy_home_logo.png' %}">
        <link type="text/css" rel="stylesheet" href="{% static 'css/avatar.css' %}"/>
        <link type="text/css" rel="stylesheet" href="{% static 'css/dropdown_menu.css' %}"/>
        <link type="text/css" rel="stylesheet" href="{% static 'css/products_managment.css' %}"/>
        <script src="{% static 'js/products_managment.js' %}"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        
        
        {% block header %}{% endblock header %}
        <style>
            .right-align {
                float: right;
                top: 0px;
                right:  -10px;  
            }
            .dropbtn {
                display: flex;
                align-items: center;
            }
              
           
              
            .button-text {
                margin-right: 0px; /* Add spacing between the button text and avatar */
              }
              
            .fa-caret-down {
                margin-left: 20px; /* Add spacing between the avatar and caret icon */
              }

            .image-container {
                display: flex;
                justify-content: center;
                align-items: center;
                height: 55vh;
            }
            
            .image-container img {
                width: 375px;
                height: 350px;
            }
            
        </style>
        
        
    </head>
    <body>{% comment %} style="background-image: url('{% static 'images/galaxy-bg.jpg' %}');" {% endcomment %}
        
            <div class="topnav" id="myTopnav">
            
                <a href="{% url 'galaxy:index' %}"  class="active">Home</a>
                
                <a href="{% url 'galaxy:pricing' %}" >Pricing</a>
                <a href="{% url 'galaxy:contact_us' %}" >Contact</a>
                <a href="{% url 'galaxy:about_us' %}" >About</a>
                {% if request.user.is_authenticated and subed %}
                    <a href="{% url 'App:apphome' %}?orgname={{user.OrganizationID}}_{{request.user.id}}">{{org|capfirst}}</a>
                {% endif %}
                {% if org_num > 1 %}
                    <a href = "{% url 'galaxy:org_choose' %}">Switch Organization</a>
                {% endif %}        
                <a href="javascript:void(0);" style="font-size:15px;" class="icon" onclick="myFunction()">&#9776;</a>
                {% if request.user.is_authenticated %}
                      
                        <div class="cart">
                            {% if request.user.user_Type == s_a %}<button id="cartbtn" onclick="opencartNav()" class="cartbtn dropbtn"><span class="price" style="color:black"><img src="{% static 'files_images/cart-orange.png' %}" draggable="false" width="25" height="30"></span><p style="color:white;">{{in_cart}}</p>
                              <i class="fa fa-caret-down"></i>
                            </button>{% endif %} 
                              
                        </div>
                        <div class="dropdown">
                            <button class="dropbtn">
                                <span class="button-text">{{ request.user.username|capfirst }}</span>
                                <div class="avatar avatar--medium active right-align">
                                  <img src="{{ request.user.avatar.url }}" draggable="false" />
                                </div>
                                <i class="fa fa-caret-down"></i>
                            </button>
                            <div class="dropdown-content">
                                
                                <a style = "cursor: pointer" onclick = "document.getElementById('userprofile').style.display = 'block' " >Profile</a>
                                {% if request.user.user_Type == s_a %}<a href="{% url 'galaxy:my_products' %}">My Products</a>{% endif %}
                                <a style = "color: red;" href="{% url 'galaxy:logout' %}"><strong>Logout</strong></a>
                            </div>
                        </div>
                        
                {% else %}
                    <a style="float: right" class="active" href = "{% url 'galaxy:login' %}">Login</a>
                {% endif %}
                  
            </div>
            <div  id="cartNav" class="cart1">
              <a href="javascript:void(0)" class="closebtn" onclick="closecartNav()" style="font-size: 40px;right: 15px;">&times;</a>
              <div class="title" style="padding-left:10px;padding-top: 10px">
                    <div>Cart</div>


                    <p></p>
              </div>
                <div >
                    <div class="container">
                        <div class="orgrow" style="display:block;font-size:small; color: black;">
                            <div class="col-24" style="padding-left:15px">
                                <h3>Products</h3>
                            </div>
                            <div class="col-24">
                                <h3><center>Qty</center></h3>
                            </div>
                            <div class="col-24">
                                <h3><center>Unit Price</center></h3>
                            </div>
                            <div class="col-24">
                                <h3><center>Delete</center></h3>
                            </div>

                        </div>

                        <div id="cartinfo" class="smallcontainer" style="display:block;">
                        <div class="orgrow">  
                          {% if cart %}
                            <div class="orgrow">
                              <div class="col-24">
                                  {% for p in cart %}
                                    <a style="alignment: left; font-size: small;" href="url">{{p.ProductID.Name}}</a>
                                  {% endfor %}
                              </div>
                              <div class="col-24">
                                  {% for p in cart %}
                                    <a style="font-size: small ;"><center>{{p.Qty}}</center></a>
                                  {% endfor %}
                              </div>
                              <div class="col-24" style="font-size: small ;">
                                  {% for p in cart %}
                                    <a style="font-size: small ;"><center>${{p.ProductID.Price}}/{{p.ProductID.Type}}</center></a>
                                  {% endfor %}
                              </div>
                              <div class="col-24" style="font-size: small ;">
                                  {% for p in cart %}
                                  <center><a class="fa fa-remove" style="font-size: large ; padding-top: 10px;" onclick="location.href='/delete_cart/{{p.ProductID.id}}'"></a></center>
                                  {% endfor %}
                              </div>
                            </div>
                          {% else %}
                            <center><h1>Empty</h1></center>
                          {% endif %}
                        </div>
                  </div>
                </div>
              </div>
              <div class="title" style="text-align: center;font-size:large">
                    <div style="text-align: center;font-size:x-large">Sub Total : ${{total}}</div>
                    <div style="text-align: center;font-size:medium">Apply Promo : <input type="text" style="width:40px;padding-right:10px"></div>
                    <div style="text-align: center;font-size:x-large">Grand Total : 550 $</div>
                    <div style="align-content: center;font-size:large;padding-right: 10%"> <input id="checkout" onclick="location.href='{% url 'galaxy:payment' %}'" type="submit" value="Continue to checkout" class="btn" style="width:90%;" ></div>
                </div>
            </div>
            
              
            
            
            
            {% block body %}
            
            {% endblock body %}
            
            {% block additional %}
            {% endblock additional %}
          
          {% include 'galaxy/profile.html' %}
          <Script> 
            function displaycartcontent()
            {
            if(document.getElementById("cartcont").style.display === 'block')
            {
                document.getElementById("cartcont").style.display = 'none';
            }
            else
            {
                document.getElementById('cartcont').style.display = 'block';
            }
            }
          </script>
          <Script>
            // Get the modal
            var modal = document.getElementById("userprofile");
        
            // Get the <span> element that closes the modal
            var span = document.getElementsByClassName("close")[0];
        
            // When the user clicks on <span> (x), close the modal
            span.onclick = function() {           
              modal.style.display = "none";
            };
        
            // When the user clicks anywhere outside of the modal, close it
            window.onclick = function(event) {            
              if (event.target === modal) {
                modal.style.display = "none";
              }
            };
          </script>
          <script>
            document. addEventListener('mouseup', function(e) {
              var container = document. getElementById('cartNav');
              if (! container. contains(e. target)) {
              container. style.width = "0%";
              }
            });
          </script>
          <Script>
            function myFunction() {
              var x = document.getElementById("myTopnav");
              if (x.className === "topnav") {
                x.className += " responsive";
              } else {
                x.className = "topnav";
              }
            }
          </script>
          <script>
            // Check for the query parameter
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('auto_button') === 'true') {
                // Find the button element by its ID or any other selector
                const button = document.getElementById("cartbtn");
        
                // Check if the button element exists
                if (button) {
                    // Add an event listener to the button
                    button.addEventListener('click', function() {
                        // Remove the query parameter from the URL
                        urlParams.delete('auto_button');
        
                        // Generate the updated URL without the query parameter
                        const updatedUrl = window.location.origin + window.location.pathname + urlParams.toString();
        
                        // Change the URL to the updated URL
                        window.history.replaceState({}, '', updatedUrl);
                    });
        
                    // Simulate a button click event
                    button.click();
                }
            }
          </script>
          <script>
            window.addEventListener("resize", resizeCurtainMenu);
            function resizeCurtainMenu() {
            var w = window.innerWidth;
            if (document.getElementById("cartNav").style.width != "0%")
              {if( w >= 1025 )
                {document.getElementById("cartNav").style.width = "50%";}
                else 
                {
                    if(w > 800 && w < 1025)
                      {document.getElementById("cartNav").style.width = "70%";}
                      else
                      {document.getElementById("cartNav").style.width = "90%";}
              }
            }
            }
          </script>
          <script>
            window.addEventListener("resize", resizeCurtainMenu);
            function resizeCurtainMenu() {
            var w = window.innerWidth;
            if (document.getElementById("orgNav").style.width != "0%")
              {if( w >= 1025 )
                {document.getElementById("orgNav").style.width = "20%";}
                else 
                {
                    if(w > 800 && w < 1025)
                      {document.getElementById("orgNav").style.width = "30%";}
                      else
                      {document.getElementById("orgNav").style.width = "50%";}
              }
            }
            }
          </script>
          
        
          {% comment %} <Script>
            {% for item in cart %}
              num = {{item.ProductID.id}} ;
              url = '/delete_cart/' + num ;
            {% endfor %}
            $("#cart-del").on("click", function (){
              fetch(url);
              url = '/delete_cart/' + num ;
            });
          </script> {% endcomment %}
            
            
            
            
            
            {% comment %} <script>
              $(document).ready(function() {
                  // Get the dropdown element
                  var dropdown = $('#cartmenu');
              
                  // Open the dropdown immediately
                  dropdown.addClass('show');
              });
            </script> {% endcomment %}
        
              {% comment %} <script>
                document.addEventListener('DOMContentLoaded', function() {
                  var urlParams = new URLSearchParams(window.location.search);
                  var dropdownId = urlParams.get('dropdown');
                  
                  if (dropdownId) {
                    var dropdown = document.getElementById(dropdownId);
                    if (dropdown) {
                      dropdown.selectedIndex = 0; // Select the first option (index 0)
                      dropdown.classList.add('open'); // Add a CSS class to make the dropdown appear open
                    }
                  }
                });
              </script> {% endcomment %}

    
    
    
    </body>
</html>

              